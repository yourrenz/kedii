<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="utf-8">
    
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <title>Kedi AR Projesi</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.2/dist/mindar-image-aframe.prod.js"></script>
    
    <style>
      body { 
        margin: 0; 
        overflow: hidden; 
        box-sizing: border-box;
        border: 8px solid darkblue; 
        height: 100vh;
      }
      .mindar-ui-overlay { display: none !important; }

      #version-logs {
        position: absolute;
        top: 15px;
        right: 15px;
        z-index: 9999; 
        background-color: rgba(255, 255, 255, 0.9); 
        border: 4px solid darkblue; 
        border-radius: 10px;
        padding: 12px;
        max-width: 220px;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 12px;
        box-shadow: -2px 2px 10px rgba(0,0,0,0.3);
      }

      #version-logs h3 { margin: 0 0 8px 0; color: darkblue; font-size: 14px; border-bottom: 2px solid darkblue; }
      #version-logs ul { list-style: none; padding: 0; margin: 0; }
      #version-logs li { margin-bottom: 5px; border-bottom: 1px solid #eee; padding-bottom: 3px; }

      #click-screen {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0, 0, 139, 0.4);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        font-family: sans-serif;
        font-weight: bold;
        text-align: center;
        cursor: pointer;
      }
    </style>

    <script>
      // Video Oynatma Mantığı
      AFRAME.registerComponent('video-handler', {
        init: function () {
          this.toggle = false;
          this.vid = document.querySelector("#kediVideo");
        },
        tick: function () {
          if (this.el.object3D.visible == true) {
            if (!this.toggle) {
              this.toggle = true;
              this.vid.play();
            }
          } else {
            this.toggle = false;
            this.vid.pause();
          }
        }
      });
    </script>
  </head>
  <body>

    <div id="click-screen" onclick="this.style.display='none'; document.querySelector('#kediVideo').play(); document.querySelector('#kediVideo').pause();">
      <h1>BAŞLATMAK İÇİN <br> EKRANA DOKUN</h1>
    </div>

    <div id="version-logs">
      <h3>Sürüm Günlükleri</h3>
      <ul>
        <li><strong>v1.5.0:</strong> "Tıkla-Başlat" katmanı eklendi. Video tetikleme mantığı tick-loop'a taşındı. (Güncel)</li>
        <li><strong>v1.4.0:</strong> Custom Component denendi.</li>
        <li><strong>v1.3.2:</strong> Dosya isimleri (kedi.mp4) düzeltildi.</li>
      </ul>
    </div>

    <a-scene mindar-image="imageTargetSrc: ./kedi_proje/targets.mind; autoStart: true; uiLoading: no; uiScanning: no;" 
             color-space="sRGB" 
             renderer="colorManagement: true, physicallyCorrectLights" 
             vr-mode-ui="enabled: false" 
             device-orientation-permission-ui="enabled: false">
      
      <a-assets>
        <video id="kediVideo" 
               src="./kedi_proje/kedi.mp4" 
               preload="auto" 
               loop="true" 
               crossorigin="anonymous" 
               playsinline 
               webkit-playsinline></video>
      </a-assets>

      <a-camera position="0 0 0" look-controls="enabled: false"></a-camera>

      <a-entity mindar-image-target="targetIndex: 0" video-handler>
        <a-video src="#kediVideo" position="0 0 0" width="1" height="0.56" rotation="0 0 0"></a-video>
      </a-entity>
    </a-scene>

  </body>
</html>
